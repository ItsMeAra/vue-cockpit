{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///vue-cockpit.min.js","webpack:///webpack/bootstrap f13b5d50b29f9a2ac465","webpack:///./src/index.js"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","init","options","data","cockpitUrl","apiKey","selector","basePath","location","pathname","slice","collections","regions","collectionsLoaded","regionsLoaded","thumbnailWidth","thumbnailQuality","hasCookie","document","cookie","length","showHints","window","search","indexOf","buttonText","$","append","click","href","split","replace","linkToCockpit","element","entityType","entityName","entityAttr","parents","css","attr","addClass","each","$this","text","segments","trim","operator","on","$event","action","url","open","fetch","then","response","json","collectionNames","forEach","collectionName","regionNames","regionName","Vue","el","created","fetchAllCollectionEntries","fetchAllRegionEntries","methods","self","i","array","isLast","fetchRegionEntries","callback","ex","console","log","fetchCollectionEntries","entries","entry","Object","keys","key","path","method","headers","Content-Type","body","JSON","stringify","src","w","q","thumbnailPath"],"mappings":"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","file":"vue-cockpit.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vueCockpit\"] = factory();\n\telse\n\t\troot[\"vueCockpit\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"vueCockpit\"] = factory();\n\telse\n\t\troot[\"vueCockpit\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports) {\n\n\tvar init = function (options) {\n\t  var data = {\n\t    cockpitUrl: options.cockpitUrl,\n\t    apiKey: options.apiKey,\n\t    selector: options.selector,\n\t    basePath: location.pathname.slice(0, -1),\n\t    collections: {},\n\t    regions: {},\n\t    collectionsLoaded: false,\n\t    regionsLoaded: false,\n\t    thumbnailWidth: options.thumbnailWidth? options.thumbnailWidth : 1920,\n\t    thumbnailQuality: options.thumbnailQuality? options.thumbnailQuality : 70\n\t  }\n\t\n\t  var hasCookie = document.cookie.length > 0;\n\t  var showHints = window.location.search.indexOf('hint') >= 0;\n\t  var buttonText = showHints ? 'Hide hints' : 'Show hints';\n\t\n\t  if (hasCookie)\n\t    $('body').append('<button id=\"toggleSegmentHints\" class=\"\" style=\"position: fixed; top: 0; right: 0; z-index: 999999; background-color: #555; color: #fff; cursor: pointer; border: 0; font-family: Sans-Serif; font-size: 14px; padding: 10px 15px;\">' + buttonText + '</button>')\n\t\n\t  $('#toggleSegmentHints').click(function () {\n\t    var location = window.location.href.split('#')[0];\n\t    if (showHints)\n\t      window.location.href = location.replace('?hints', '');\n\t    else\n\t      window.location.href = location + '?hints';\n\t  });\n\t\n\t  if (showHints > 0) {\n\t\n\t    var linkToCockpit = function (element, entityType, entityName, entityAttr) {\n\t      if (element.parents('.has-binding').length == 0) {\n\t        element.css('outline', '1px dashed red').css('cursor', 'pointer');\n\t        element.attr('entity-type', entityType);\n\t        element.attr('entity-name', entityName);\n\t        element.attr('title', entityType + ' > ' + entityName + (entityAttr && entityAttr.indexOf(' ') == -1 ? (' > ' + entityAttr) : ''));\n\t        element.addClass('has-binding');\n\t      }\n\t    }\n\t\n\t    $(':not(:has(div)):contains(\"{{\")').each(function () {\n\t      var $this = $(this);\n\t      var text = $this.text();\n\t      if (text.indexOf('regions.') > 0 || text.indexOf('collections.') > 0) {\n\t        var segments = text.trim().replace('{{', '').replace('}}', '').split('.');\n\t        var entityType = segments[0];\n\t        var entityName = segments[1];\n\t        var entityAttr = segments[2];\n\t        linkToCockpit($this, entityType, entityName, entityAttr);\n\t      }\n\t    });\n\t\n\t    $('[v-for]').each(function () {\n\t      var $this = $(this);\n\t      var text = $this.attr('v-for');\n\t      var operator = text.indexOf(' in ') > 0 ? 'in' : 'of';\n\t      var entityType = text.split(' ' + operator + ' ')[1].split('.')[0];\n\t      var entityName = text.split('.')[1];\n\t      var entityAttr = text.split('.')[2];\n\t      linkToCockpit($this, entityType, entityName, entityAttr);\n\t    });\n\t\n\t    $('[v-html]').each(function () {\n\t      var $this = $(this);\n\t      var text = $this.attr('v-html');\n\t      var segments = text.split('.');\n\t      var entityType = segments[0];\n\t      var entityName = segments[1];\n\t      var entityAttr = segments[2];\n\t      linkToCockpit($this, entityType, entityName, entityAttr);\n\t    });\n\t\n\t    $('[v-bind\\\\:href]').each(function () {\n\t      var $this = $(this);\n\t      var text = $this.attr('v-bind:href');\n\t      var segments = text.split('.');\n\t      var entityType = 'regions';\n\t      var entityName = segments[1];\n\t      var entityAttr = segments[2];\n\t      linkToCockpit($this, entityType, entityName, entityAttr);\n\t    });\n\t\n\t    $('[v-bind\\\\:src]').each(function () {\n\t      var $this = $(this);\n\t      var text = $this.attr('v-bind:src');\n\t      var segments = text.split('.');\n\t      var entityType = 'regions';\n\t      var entityName = segments[1];\n\t      var entityAttr = segments[2];\n\t      linkToCockpit($this, entityType, entityName, entityAttr);\n\t    });\n\t\n\t    $('body').on('click', '.has-binding', function ($event) {\n\t      var $this = $(this);\n\t      var entityType = $this.attr('entity-type');\n\t      var entityName = $this.attr('entity-name');\n\t      var action = entityType == 'regions' ? 'form' : 'entries';\n\t      var url = data.cockpitUrl + '/' + entityType + '/' + action + '/' + entityName;\n\t      window.open(url);\n\t      //window.location.href = url;\n\t    });\n\t  }\n\t\n\t  fetch(data.cockpitUrl + '/api/collections/listCollections?token=' + data.apiKey)\n\t    .then(function (response) {\n\t      return response.json()\n\t    }).then(function (collectionNames) {\n\t      data.collectionNames = collectionNames\n\t      collectionNames.forEach(function (collectionName) {\n\t        data.collections[collectionName] = [];\n\t      });\n\t      fetch(data.cockpitUrl + '/api/regions/listRegions?token=' + data.apiKey)\n\t        .then(function (response) {\n\t          return response.json()\n\t        }).then(function (regionNames) {\n\t          data.regionNames = regionNames;\n\t          regionNames.forEach(function (regionName) {\n\t            data.regions[regionName] = [];\n\t          });\n\t          new Vue({\n\t            el: data.selector,\n\t            data: data,\n\t            created: function () {\n\t              this.fetchAllCollectionEntries();\n\t              this.fetchAllRegionEntries();\n\t            },\n\t            methods: {\n\t              fetchAllRegionEntries: function () {\n\t                var self = this;\n\t                this.regionNames.forEach(function (regionName, i, array) {\n\t                  var isLast = i == array.length - 1;\n\t                  self.fetchRegionEntries(regionName, isLast);\n\t                });\n\t              },\n\t              fetchRegionEntries: function (regionName, isLast) {\n\t                var self = this;\n\t                fetch(data.cockpitUrl + '/api/regions/data/' + regionName + '?token=' + this.apiKey)\n\t                  .then(function (response) {\n\t                    return response.json();\n\t                  }).then(function (json) {\n\t                    self.regions[regionName] = json;\n\t                    self.regionsLoaded = self.regionsLoaded || isLast;\n\t                    if (self.regionsLoaded && self.collectionsLoaded && options.callback)\n\t                      options.callback();\n\t                  }).catch(function (ex) {\n\t                    console.log('parsing failed', ex)\n\t                  })\n\t              },\n\t              fetchAllCollectionEntries: function () {\n\t                var self = this;\n\t                this.collectionNames.forEach(function (collectionName, i, array) {\n\t                  var isLast = i == array.length - 1;\n\t                  self.fetchCollectionEntries(collectionName, isLast);\n\t                });\n\t              },\n\t              fetchCollectionEntries: function (collectionName, isLast) {\n\t                var self = this;\n\t                fetch(data.cockpitUrl + '/api/collections/get/' + collectionName + '?token=' + this.apiKey)\n\t                  .then(function (response) {\n\t                    return response.json();\n\t                  }).then(function (json) {\n\t                    json.entries.forEach(function (entry) {\n\t                      Object.keys(entry).forEach(function (key) {\n\t                        if (entry[key].path) {\n\t                          fetch(data.cockpitUrl + '/api/cockpit/image?token=' + self.apiKey, {\n\t                            method: 'POST',\n\t                            headers: { 'Content-Type': 'application/json' },\n\t                            body: JSON.stringify({\n\t                              'src': entry[key].path,\n\t                              'm': 'resize',\n\t                              'w': data.thumbnailWidth,\n\t                              'q': data.thumbnailQuality\n\t                            })\n\t                          })\n\t                            .then(function (response) {\n\t                              return response.text();\n\t                            }).then(function (text) {\n\t                              entry[key].thumbnailPath = text;\n\t                            }).catch(function (ex) {\n\t                              console.log('parsing failed', ex)\n\t                            })\n\t                        }\n\t                      });\n\t                    })\n\t                    self.collections[collectionName] = json.entries;\n\t                    self.collectionsLoaded = self.collectionsLoaded || isLast;\n\t                    if (self.regionsLoaded && self.collectionsLoaded && options.callback)\n\t                      options.callback();\n\t                  }).catch(function (ex) {\n\t                    console.log('parsing failed', ex)\n\t                  })\n\t              }\n\t            }\n\t          })\n\t        })\n\t    }).catch(function (ex) {\n\t      console.log('parsing failed', ex)\n\t    })\n\t}\n\t\n\tmodule.exports = {\n\t  init: init\n\t}\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** vue-cockpit.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap f13b5d50b29f9a2ac465\n **/","var init = function (options) {\n  var data = {\n    cockpitUrl: options.cockpitUrl,\n    apiKey: options.apiKey,\n    selector: options.selector,\n    basePath: location.pathname.slice(0, -1),\n    collections: {},\n    regions: {},\n    collectionsLoaded: false,\n    regionsLoaded: false,\n    thumbnailWidth: options.thumbnailWidth? options.thumbnailWidth : 1920,\n    thumbnailQuality: options.thumbnailQuality? options.thumbnailQuality : 70\n  }\n\n  var hasCookie = document.cookie.length > 0;\n  var showHints = window.location.search.indexOf('hint') >= 0;\n  var buttonText = showHints ? 'Hide hints' : 'Show hints';\n\n  if (hasCookie)\n    $('body').append('<button id=\"toggleSegmentHints\" class=\"\" style=\"position: fixed; top: 0; right: 0; z-index: 999999; background-color: #555; color: #fff; cursor: pointer; border: 0; font-family: Sans-Serif; font-size: 14px; padding: 10px 15px;\">' + buttonText + '</button>')\n\n  $('#toggleSegmentHints').click(function () {\n    var location = window.location.href.split('#')[0];\n    if (showHints)\n      window.location.href = location.replace('?hints', '');\n    else\n      window.location.href = location + '?hints';\n  });\n\n  if (showHints > 0) {\n\n    var linkToCockpit = function (element, entityType, entityName, entityAttr) {\n      if (element.parents('.has-binding').length == 0) {\n        element.css('outline', '1px dashed red').css('cursor', 'pointer');\n        element.attr('entity-type', entityType);\n        element.attr('entity-name', entityName);\n        element.attr('title', entityType + ' > ' + entityName + (entityAttr && entityAttr.indexOf(' ') == -1 ? (' > ' + entityAttr) : ''));\n        element.addClass('has-binding');\n      }\n    }\n\n    $(':not(:has(div)):contains(\"{{\")').each(function () {\n      var $this = $(this);\n      var text = $this.text();\n      if (text.indexOf('regions.') > 0 || text.indexOf('collections.') > 0) {\n        var segments = text.trim().replace('{{', '').replace('}}', '').split('.');\n        var entityType = segments[0];\n        var entityName = segments[1];\n        var entityAttr = segments[2];\n        linkToCockpit($this, entityType, entityName, entityAttr);\n      }\n    });\n\n    $('[v-for]').each(function () {\n      var $this = $(this);\n      var text = $this.attr('v-for');\n      var operator = text.indexOf(' in ') > 0 ? 'in' : 'of';\n      var entityType = text.split(' ' + operator + ' ')[1].split('.')[0];\n      var entityName = text.split('.')[1];\n      var entityAttr = text.split('.')[2];\n      linkToCockpit($this, entityType, entityName, entityAttr);\n    });\n\n    $('[v-html]').each(function () {\n      var $this = $(this);\n      var text = $this.attr('v-html');\n      var segments = text.split('.');\n      var entityType = segments[0];\n      var entityName = segments[1];\n      var entityAttr = segments[2];\n      linkToCockpit($this, entityType, entityName, entityAttr);\n    });\n\n    $('[v-bind\\\\:href]').each(function () {\n      var $this = $(this);\n      var text = $this.attr('v-bind:href');\n      var segments = text.split('.');\n      var entityType = 'regions';\n      var entityName = segments[1];\n      var entityAttr = segments[2];\n      linkToCockpit($this, entityType, entityName, entityAttr);\n    });\n\n    $('[v-bind\\\\:src]').each(function () {\n      var $this = $(this);\n      var text = $this.attr('v-bind:src');\n      var segments = text.split('.');\n      var entityType = 'regions';\n      var entityName = segments[1];\n      var entityAttr = segments[2];\n      linkToCockpit($this, entityType, entityName, entityAttr);\n    });\n\n    $('body').on('click', '.has-binding', function ($event) {\n      var $this = $(this);\n      var entityType = $this.attr('entity-type');\n      var entityName = $this.attr('entity-name');\n      var action = entityType == 'regions' ? 'form' : 'entries';\n      var url = data.cockpitUrl + '/' + entityType + '/' + action + '/' + entityName;\n      window.open(url);\n      //window.location.href = url;\n    });\n  }\n\n  fetch(data.cockpitUrl + '/api/collections/listCollections?token=' + data.apiKey)\n    .then(function (response) {\n      return response.json()\n    }).then(function (collectionNames) {\n      data.collectionNames = collectionNames\n      collectionNames.forEach(function (collectionName) {\n        data.collections[collectionName] = [];\n      });\n      fetch(data.cockpitUrl + '/api/regions/listRegions?token=' + data.apiKey)\n        .then(function (response) {\n          return response.json()\n        }).then(function (regionNames) {\n          data.regionNames = regionNames;\n          regionNames.forEach(function (regionName) {\n            data.regions[regionName] = [];\n          });\n          new Vue({\n            el: data.selector,\n            data: data,\n            created: function () {\n              this.fetchAllCollectionEntries();\n              this.fetchAllRegionEntries();\n            },\n            methods: {\n              fetchAllRegionEntries: function () {\n                var self = this;\n                this.regionNames.forEach(function (regionName, i, array) {\n                  var isLast = i == array.length - 1;\n                  self.fetchRegionEntries(regionName, isLast);\n                });\n              },\n              fetchRegionEntries: function (regionName, isLast) {\n                var self = this;\n                fetch(data.cockpitUrl + '/api/regions/data/' + regionName + '?token=' + this.apiKey)\n                  .then(function (response) {\n                    return response.json();\n                  }).then(function (json) {\n                    self.regions[regionName] = json;\n                    self.regionsLoaded = self.regionsLoaded || isLast;\n                    if (self.regionsLoaded && self.collectionsLoaded && options.callback)\n                      options.callback();\n                  }).catch(function (ex) {\n                    console.log('parsing failed', ex)\n                  })\n              },\n              fetchAllCollectionEntries: function () {\n                var self = this;\n                this.collectionNames.forEach(function (collectionName, i, array) {\n                  var isLast = i == array.length - 1;\n                  self.fetchCollectionEntries(collectionName, isLast);\n                });\n              },\n              fetchCollectionEntries: function (collectionName, isLast) {\n                var self = this;\n                fetch(data.cockpitUrl + '/api/collections/get/' + collectionName + '?token=' + this.apiKey)\n                  .then(function (response) {\n                    return response.json();\n                  }).then(function (json) {\n                    json.entries.forEach(function (entry) {\n                      Object.keys(entry).forEach(function (key) {\n                        if (entry[key].path) {\n                          fetch(data.cockpitUrl + '/api/cockpit/image?token=' + self.apiKey, {\n                            method: 'POST',\n                            headers: { 'Content-Type': 'application/json' },\n                            body: JSON.stringify({\n                              'src': entry[key].path,\n                              'm': 'resize',\n                              'w': data.thumbnailWidth,\n                              'q': data.thumbnailQuality\n                            })\n                          })\n                            .then(function (response) {\n                              return response.text();\n                            }).then(function (text) {\n                              entry[key].thumbnailPath = text;\n                            }).catch(function (ex) {\n                              console.log('parsing failed', ex)\n                            })\n                        }\n                      });\n                    })\n                    self.collections[collectionName] = json.entries;\n                    self.collectionsLoaded = self.collectionsLoaded || isLast;\n                    if (self.regionsLoaded && self.collectionsLoaded && options.callback)\n                      options.callback();\n                  }).catch(function (ex) {\n                    console.log('parsing failed', ex)\n                  })\n              }\n            }\n          })\n        })\n    }).catch(function (ex) {\n      console.log('parsing failed', ex)\n    })\n}\n\nmodule.exports = {\n  init: init\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/index.js\n ** module id = 0\n ** module chunks = 0\n **/"],"sourceRoot":""}